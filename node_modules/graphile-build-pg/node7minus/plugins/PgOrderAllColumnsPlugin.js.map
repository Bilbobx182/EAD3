{"version":3,"sources":["../../src/plugins/PgOrderAllColumnsPlugin.js"],"names":["PgOrderAllColumnsPlugin","builder","inflection","pgInflection","hook","values","build","context","extend","introspectionResultsByKind","pgIntrospectionResultsByKind","pgColumnFilter","scope","isPgRowSortEnum","table","pgIntrospection","kind","attribute","filter","attr","classId","id","reduce","memo","ascFieldName","orderByEnum","name","namespaceName","descFieldName","value","alias","toLowerCase","specs"],"mappings":";;;;;;kBAGgB,SAASA,uBAAT,CACdC,OADc,QAGd;AAAA,MADgBC,UAChB,QADEC,YACF;;AACAF,UAAQG,IAAR,CAAa,wBAAb,EAAuC,UAACC,MAAD,EAASC,KAAT,EAAgBC,OAAhB,EAA4B;AAAA,QAE/DC,MAF+D,GAK7DF,KAL6D,CAE/DE,MAF+D;AAAA,QAGjCC,0BAHiC,GAK7DH,KAL6D,CAG/DI,4BAH+D;AAAA,QAI/DC,cAJ+D,GAK7DL,KAL6D,CAI/DK,cAJ+D;AAAA,yBAMFJ,OANE,CAMzDK,KANyD;AAAA,QAMhDC,eANgD,kBAMhDA,eANgD;AAAA,QAMdC,KANc,kBAM/BC,eAN+B;;AAOjE,QAAI,CAACF,eAAD,IAAoB,CAACC,KAArB,IAA8BA,MAAME,IAAN,KAAe,OAAjD,EAA0D;AACxD,aAAOX,MAAP;AACD;AACD,WAAOG,OACLH,MADK,EAELI,2BAA2BQ,SAA3B,CACGC,MADH,CACU;AAAA,aAAQC,KAAKC,OAAL,KAAiBN,MAAMO,EAA/B;AAAA,KADV,EAEGH,MAFH,CAEU;AAAA,aAAQP,eAAeQ,IAAf,EAAqBb,KAArB,EAA4BC,OAA5B,CAAR;AAAA,KAFV,EAGGe,MAHH,CAGU,UAACC,IAAD,EAAOJ,IAAP,EAAgB;AACtB,UAAMK,eAAetB,WAAWuB,WAAX,CACnBN,KAAKO,IADc,EAEnB,IAFmB,EAGnBZ,MAAMY,IAHa,EAInBZ,MAAMa,aAJa,CAArB;AAMA,UAAMC,gBAAgB1B,WAAWuB,WAAX,CACpBN,KAAKO,IADe,EAEpB,KAFoB,EAGpBZ,MAAMY,IAHc,EAIpBZ,MAAMa,aAJc,CAAtB;AAMAJ,WAAKC,YAAL,IAAqB;AACnBK,eAAO;AACLC,iBAAON,aAAaO,WAAb,EADF;AAELC,iBAAO,CAAC,CAACb,KAAKO,IAAN,EAAY,IAAZ,CAAD;AAFF;AADY,OAArB;AAMAH,WAAKK,aAAL,IAAsB;AACpBC,eAAO;AACLC,iBAAOF,cAAcG,WAAd,EADF;AAELC,iBAAO,CAAC,CAACb,KAAKO,IAAN,EAAY,KAAZ,CAAD;AAFF;AADa,OAAtB;AAMA,aAAOH,IAAP;AACD,KA7BH,EA6BK,EA7BL,CAFK,EAgCJ,mCAAkCT,MAAMY,IAAK,GAhCzC,CAAP;AAkCD,GA5CD;AA6CD,C","file":"PgOrderAllColumnsPlugin.js","sourcesContent":["// @flow\nimport type { Plugin } from \"graphile-build\";\n\nexport default (function PgOrderAllColumnsPlugin(\n  builder,\n  { pgInflection: inflection }\n) {\n  builder.hook(\"GraphQLEnumType:values\", (values, build, context) => {\n    const {\n      extend,\n      pgIntrospectionResultsByKind: introspectionResultsByKind,\n      pgColumnFilter,\n    } = build;\n    const { scope: { isPgRowSortEnum, pgIntrospection: table } } = context;\n    if (!isPgRowSortEnum || !table || table.kind !== \"class\") {\n      return values;\n    }\n    return extend(\n      values,\n      introspectionResultsByKind.attribute\n        .filter(attr => attr.classId === table.id)\n        .filter(attr => pgColumnFilter(attr, build, context))\n        .reduce((memo, attr) => {\n          const ascFieldName = inflection.orderByEnum(\n            attr.name,\n            true,\n            table.name,\n            table.namespaceName\n          );\n          const descFieldName = inflection.orderByEnum(\n            attr.name,\n            false,\n            table.name,\n            table.namespaceName\n          );\n          memo[ascFieldName] = {\n            value: {\n              alias: ascFieldName.toLowerCase(),\n              specs: [[attr.name, true]],\n            },\n          };\n          memo[descFieldName] = {\n            value: {\n              alias: descFieldName.toLowerCase(),\n              specs: [[attr.name, false]],\n            },\n          };\n          return memo;\n        }, {}),\n      `Adding order values from table '${table.name}'`\n    );\n  });\n}: Plugin);\n"]}